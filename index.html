<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Battleship</title>
		<link rel="stylesheet" href="style.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@100&display=swap">

        <!--React is the main library-->
        <script src="https://unpkg.com/react@16/umd/react.development.js"></script>

        <!--ReactDOM is a special package that allows us to take react components-->
        <!--and insert into the Document Object Model (DOM)-->
        <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>

        <!--Babel translates JSX into javascript-->
        <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    </head>
    <body>
        <div id="app"></div>

        <!--Whenever scripting in JSX, you must add attribute type="text/babel" to translate to javascript-->
        <script type="text/babel">

         class Player extends React.Component {
            constructor(props) {
               super(props);

               this.state = {
                  boats: new Map(),
                  hits: new Set(),

                  L_life: 4,
                  Box_life: 4,
                  Line1_Life: 4,
                  Line2_Life: 4
               };
            }

            getPlayerStyle = (offset) => {
               const boatColours = {
                  L: 'orange',
                  Box: 'yellow',
                  Line1: 'cyan',
                  Line2: 'green'
               }

               let style = {
                  backgroundColor: boatColours[this.state.boats.get(offset)]
               }

               return style
            }

            render() {
               const gridItems = [];
               const letters = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'];

               gridItems.push(<div />)
               // header for columns
               for (let i = 0; i < 8; i++) {
                     gridItems.push(<div className="header-column">{i+1}</div>)
               }

               for (let i = 0; i < 8; i++) {
                  // header for rows
                  gridItems.push(<div className="header-row">{letters[i]}</div>)
                  
                  for (let j = 0; j < 8; j++) {
                     const offset = 8*i + j

                     if (this.props.mode == "player") {
                        const style = this.getPlayerStyle(offset);

                        gridItems.push(<button class="button-grid" disabled={true} style={style}>{this.state.boats.get(offset)}</button>)

                     } else if (this.props.mode == "opponent") {
                        gridItems.push(<button class="button-grid"></button>)
                     }
                  }
               }
               
               return (
                  <div className="grid">
                     {gridItems}
                  </div>
               )
            }
         }

         class Player1 extends Player {
            constructor(props) {
               super(props);

               const newBoats = this.state.boats;
               newBoats.set(0, 'L')
               newBoats.set(8, 'L')
               newBoats.set(16, 'L')
               newBoats.set(17, 'L')

               newBoats.set(54, 'Box')
               newBoats.set(55, 'Box')
               newBoats.set(62, 'Box')
               newBoats.set(63, 'Box') 

               newBoats.set(3, 'Line1')
               newBoats.set(11, 'Line1')
               newBoats.set(19, 'Line1')
               newBoats.set(27, 'Line1')

               newBoats.set(33, 'Line2')
               newBoats.set(41, 'Line2')
               newBoats.set(49, 'Line2')
               newBoats.set(57, 'Line2')

               this.state.boats = newBoats;
            }
         }

         class Player2 extends Player {

         }
        
         class App extends React.Component {
            render() {
                return (
                    <div>
                        <h1 className="title">Battleship</h1>
                        <div id="container">
                            <div>
                                <h2>Your grid (P1)</h2>
                                <hr />
                                <Player1 mode="player"/>
                            </div>
                            <div>
                                <h2>Opponent (P2)</h2>
                                <hr />
                                <Player1 mode="opponent" />
                            </div>
                            <button className="button-big">End Turn</button>
                        </div>
                    </div>
                );
            }
        }

        ReactDOM.render(<App />, document.querySelector('#app'));
        </script>
    </body>
</html>